## Adatbázis
\label{ch:database}

### Adatbázis-kezelő rendszer kiválasztása
Az adatbázis-kezelő rendszer megfelelő kiválasztása jelentős befolyással van arra, hogy a fejlesztés
során mennyire lesz egyszerű dolgunk az adatkezeléssel. Pont ezért fontos, hogy jól végiggondolt
döntést hozzunk, hiszen ha a fejlesztés közben jövünk rá, hogy mégse a jó fejlesztői eszközt választottuk,
akkor nehézkes és sok munkát igénylő lesz az átállás.

Mivel a rendszerbe folyamatosan temérdek mennyiségű adat érkezik és ezek az adatok nem éppen a
legrendezettebbek vagy éppen sémába illeszthetőek érdekes és nem mindennapi feltételeknek kell megfelelnie
a kívánt adatbázis-kezelő rendszer. Továbbá a beérkező adatok, amiket tárolni szeretnénk általában
magukban értelmezhető kis egységeket alkotnak és így kevés vagy akár semennyi kapcsolat nem létezik
köztük. Ezen okok miatt arra kellett jussak, mikor a megfelelő adatbázis-kezelő rendszer után kutattam,
hogy egy relációs adatbázis egyáltalán nem lenne kedvező választás. Habár az ilyen típusú adatbázisok
mára csodálatra méltó teljesítményre képesek és valószínűleg meg lehet oldani velük is alig rendezett
adatok tárolását inkább a NoSQL adatbázisok felé tereltem figyelmemet.

A NoSQL adatbázisokról hallhattunk úgy, mint a modern kor adattárolásának megmentői, hiszen pont
a régi, reláció alapú adatbázisok okozta problémákat próbálják orvosolni. Egyre több alkalmazás mögött
áll elképesztő mennyiségű adat, aminek kezelése nagy kihívások elé állítja a fejlesztőket. Az egyik
legfontosabb szemponttá vált a skálázhatóság az alkalmazások megtervezésénél és míg a relációs adatbázisok
nehézkes és vertikális skálázhatóságot biztosítottak csak, addig a legtöbb NoSQL adatbázis beépítetten
támogatja a horizontális skálázhatóságot. Ezt az előnyt tovább fokozza az a tény, hogy a szoftverfejlesztés
egyre jobban halad a felhő alapú architektúrák használata felé, aminek jelentősen kedvez egy horizontálisan
skálázható, sok csomópontból álló adatbázis klaszter.

NoSQL adatbázisokon belül is van többféle, lehet gráf adatbázis, kulcs-érték adatbázis vagy éppen
dokumentumorientált adatbázis. Mindegyiknek meg van a maga előnye, például egy gráf adatbázisban
könnyedén ábrázolhatunk kapcsolatokat, összefüggéseket az adataink között vagy egy dokumentumorientált
tárolás esetén lehetőségünk van egy folyamatosan változó, sémamentes módon kezelni az adatainkat.
A mi esetünkben megfelelő egy dokumentumorientált adatbázis használata, mert sémamentes tárolás nagy
szabadságot ad, amire szükségünk lesz az eszközöktől érkező állapotjelentő üzenetek strukturálatlansága
miatt.

Rengeteg dokumentumorientált NoSQL adatbázis létezik a világon, ezért csak arra a pár jelentősebbre
fogok kitérni, amik illenek a mi használati esetünkhöz. Ezek név szerint a *MongoDB* és a *Couchbase*
adatbázis-kezelő rendszerek, melyek rendre az 1. és a 3. legelterjedtebb dokumentumorientált adatbázisok
a világon [@DBEngines]. A 2. helyen áll az Amazon által fejlesztett *DynamoDB*, ami csak azért marad ki,
mert logikus módon erősen épít az Amazon által nyújtott felhőszolgáltatásokra és nem célunk, hogy ilyen
felhő alapú rendszert készítsünk. A *MongoDB* és a *Couchbase* közötti első szembetűnő különbség az
adatelérésben rejlik. A *MongoDB* SQL-hez hasonló lekérésekkel dolgozik kollekciókon, amik megfelelnek
a relációs adatbázis tábláinak, a *Couchbase* esetében pedig különböző nézeteket határozhatunk meg előre,
más-más szempont szerint. A *Couchbase* előre meghatározottságából adódik, hogy csak akkor érdemes
használni, ha ritkán kell változtatni az adatok struktúráját és ha tudjuk előre, hogy mit és milyen
formában szeretnénk lekérni az adatokat. Ezzel ellentétben áll a *MongoDB* rugalmas lekérdező nyelve,
mely az SQL-hez hasonlóan tartalmaz logikai vagy éppen matematikai operátorokat. Illetve ezt a rugalmasságot
kiegészíti még a *MongoDB* úgynevezett aggregációs keretrendszere, mely csővezetékszerűen egymás után
kapcsolható szűrők és transzformációk végrehajtását teszi lehető az adatokon. Ez által aránylag kevés
munka befektetésével hamar tudunk olyan lekérdezéseket írni, amiket felhasználva következtetéseket
tudunk levonni az adataink alapján.

Ezek alapján úgy láttam, hogy a *MongoDB* lesz az az adatbázis-kezelő rendszer, ami legjobban kielégíti
az igényeinket. Mivel aránylag közel áll a relációs adatbázisok fogalomvilágához, könnyedén át tudtam
térni a használatára. Az aggregációs keretrendszer tökéletes eszköz akármilyen statisztika elkészítésére,
amit a felhasználóknak megjelenítünk. Dokumentumorientáltságának és sémamentességének köszönhetően
tudtam olyan tárolási megoldást találni, ami leegyszerűsíti a folyamatosan bejövő adat kezelését, de
ezt majd a \ref{ch:db_schema}. alfejezetben fogom részletezni.

### Tárolási sémák
\label{ch:db_schema}
